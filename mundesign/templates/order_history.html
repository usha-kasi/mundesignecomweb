{% extends "base.html" %}

{% block title %} Order History {% endblock %}

{% block content %}
<div class="container">
    <h1>Order History</h1>
    <table id="order-history-table" border="1">
        <tr>
            <th>Order ID</th>
            <th>Order Date</th>
            <th>Items Purchased</th>
            <th>Total Amount</th>
            <th>Order Status</th>
            <th>Delivery Address</th>
            <th>Delivery Date</th>
        </tr>
    </table>
</div>

<script>
    async function fetchOrderHistory() {
        try {
            const response = await fetch('{% url "order_history_json" %}');
            const orders = await response.json();
            const table = document.getElementById('order-history-table');
            
            orders.forEach(order => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${order.order_id}</td>
                    <td>${order.order_date}</td>
                    <td>${order.items_purchased}</td>
                    <td>${order.total_amount}</td>
                    <td>${order.order_status}</td>
                    <td>${order.delivery_address}</td>
                    <td>${order.delivery_date}</td>
                `;
                table.appendChild(row);
            });
        } catch (error) {
            console.error('Error fetching order history:', error);
        }
    }

    window.onload = fetchOrderHistory;
</script>
{% endblock %}


